<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#f6a7d9" />
  <title>Aurora Mailbox ✨</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.webmanifest" />
  <link rel="apple-touch-icon" href="icons/icon-512.png" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="Aurora Mailbox" />

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;700;800&family=Comfortaa:wght@500;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <!-- Aurora background magic -->
  <div class="aurora">
    <span class="blob b1"></span>
    <span class="blob b2"></span>
    <span class="blob b3"></span>
    <span class="stars"></span>
  </div>

  <header class="app-header glass">
    <div class="brand">
      <span class="logo">🌸</span>
      <h1>Aurora Mailbox</h1>
    </div>
    <button id="settingsBtn" class="icon-btn" aria-label="Open settings">⚙️</button>
  </header>

  <main class="container">
    <!-- Tabs -->
    <nav class="tabs glass">
      <button class="tab active" data-tab="compose" aria-controls="composePanel">
        💌 Send Magic
      </button>
      <button class="tab" data-tab="inbox" aria-controls="inboxPanel">
        📚 My Letters
      </button>
    </nav>

    <!-- Compose Panel -->
    <section id="composePanel" class="panel active">
      <div class="card glass">
        <h2>Write yourself a love note ✨</h2>
        <label class="field">
          <span>Title</span>
          <input id="mailTitle" type="text" placeholder="A tiny sparkle of thought..." maxlength="120" />
        </label>
        <label class="field">
          <span>Body</span>
          <textarea id="mailBody" rows="8" placeholder="Pour your heart out with glitter and grace..."></textarea>
        </label>
        <div class="actions">
          <button id="sendBtn" class="btn primary">
            Send with Starlight ✨
          </button>
          <button id="clearBtn" class="btn ghost">Clear</button>
        </div>
        <p id="composeHint" class="hint">Your note travels to your secret constellation (a JSON file in your GitHub repo) when you press send.</p>
        <p id="composeStatus" class="status"></p>
      </div>
    </section>

    <!-- Inbox Panel -->
    <section id="inboxPanel" class="panel">
      <div class="inbox-controls">
        <button id="refreshBtn" class="btn small">Refresh ✨</button>
        <span id="inboxStatus" class="status"></span>
      </div>
      <div id="inboxGrid" class="masonry"></div>
      <template id="cardTemplate">
        <article class="note-card glass">
          <h3 class="note-title"></h3>
          <p class="note-preview"></p>
          <div class="note-meta">
            <span class="date"></span>
            <button class="read-btn">Open</button>
          </div>
        </article>
      </template>
    </section>
  </main>

  <!-- Reader Modal -->
  <dialog id="readerModal" class="modal glass">
    <div class="modal-header">
      <h3 id="readerTitle">Title</h3>
      <button id="closeReader" class="icon-btn" aria-label="Close">✖️</button>
    </div>
    <article id="readerBody" class="reader-body"></article>
    <div class="modal-footer">
      <button id="deleteBtn" class="btn danger">Delete</button>
      <button id="shareBtn" class="btn">Share</button>
    </div>
  </dialog>

  <!-- Token Modal -->
  <dialog id="tokenModal" class="modal glass">
    <form method="dialog" id="tokenForm" class="token-form">
      <h3>Welcome to your Aurora Mailbox 🌙</h3>
      <p class="soft">To let your letters float among the stars, whisper your Magic Key (GitHub token) below.</p>
      <label class="field">
        <span>Magic Key</span>
        <input id="tokenInput" type="password" placeholder="ghp_...sparkly_secret..." autocomplete="off" required />
      </label>
      <label class="toggle">
        <input id="rememberToggle" type="checkbox" />
        <span>Remember my Magic Key on this device</span>
      </label>
      <details class="gentle">
        <summary>How to conjure a Magic Key</summary>
        <ol class="steps">
          <li>Go to GitHub → Settings → Developer settings → Personal access tokens → Fine-grained tokens.</li>
          <li>Select your repo, and grant Repository permissions → Contents: Read and write.</li>
          <li>Copy the token (starts with ghp_ or github_pat_...). Keep it secret, keep it safe.</li>
        </ol>
      </details>
      <div class="actions">
        <button class="btn primary" id="saveTokenBtn">Begin the magic ✨</button>
      </div>
      <p class="hint">We keep your secret only on this device. You can remove it anytime in Settings.</p>
    </form>
  </dialog>

  <!-- Settings Modal (Simplified: Magic Key only) -->
  <dialog id="settingsModal" class="modal glass">
    <div class="modal-header">
      <h3>Magic Key ✨</h3>
      <button id="closeSettings" class="icon-btn" aria-label="Close">✖️</button>
    </div>
    <div class="settings-body" style="padding: 0 14px 14px;">
      <p class="soft">Manage your secret Magic Key (GitHub token) here.</p>
      <div class="sep"></div>
      <div class="grid2">
        <button id="reenterTokenBtn" class="btn">Re-enter Magic Key</button>
        <button id="forgetTokenBtn" class="btn danger">Forget Magic Key</button>
      </div>
      <p class="hint">Your secret lives only on this device. Re-enter or forget it anytime.</p>
    </div>
  </dialog>

  <!-- Update Available Modal -->
  <dialog id="updateModal" class="modal glass">
    <div class="modal-header">
      <h3>Fresh Starlight Awaits ✨</h3>
      <button id="closeUpdate" class="icon-btn" aria-label="Close">✖️</button>
    </div>
    <article class="reader-body">
      <p>A new sprinkle of Aurora magic is ready. Update now or later?</p>
    </article>
    <div class="modal-footer">
      <button id="updateLaterBtn" class="btn ghost">Later</button>
      <button id="updateNowBtn" class="btn primary">Update now ✨</button>
    </div>
  </dialog>

  <footer class="app-footer">
    <p id="creditLink" role="button" tabindex="0" aria-label="Credits">&lt;/&gt; with 🪄 by Spandan.</p>
  </footer>

  <script src="app.js" type="module"></script>
</body>
</html>